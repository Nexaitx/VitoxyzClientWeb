import{b as Le,d as Ae}from"./chunk-EYK4262I.js";import{a as j,b as F}from"./chunk-2XPCGB4B.js";import"./chunk-Z7PFBBRY.js";import"./chunk-ORWMEHPN.js";import{A as b,C as me,D as _e,E as fe,G as ye,H as ve,J as Me,K as be,L as Ce,M as ze,N as ke,O as we,P as Ie,Q as Se,R as xe,T as De,U as Ee,W as Oe,z as he}from"./chunk-STUMPHAT.js";import{b as pe}from"./chunk-AM2LVYM3.js";import{h as se,i as le,l as de,m as ce,s as ge,t as ue}from"./chunk-6DS5PDWY.js";import{$ as U,Ab as k,Eb as u,Fb as l,Gb as o,Hb as m,Ib as ie,Jb as ne,Lb as Z,Mb as V,Ob as S,Rb as C,Sb as re,Tb as c,Xb as ae,Ya as d,Yb as $,Zb as q,a as O,aa as Y,b as B,bb as X,dc as E,ea as G,fc as p,gc as oe,hc as D,ib as L,jb as ee,ka as v,l as J,la as M,nb as I,nc as A,qb as te,sc as N,tc as Q,zb as z}from"./chunk-HGK6BT6U.js";var Fe=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275mod=ee({type:a});static \u0275inj=Y({})}return a})();var Ne=["mapElement"],H=class a{mapElement;locationSelected=new te;userLat=28.6139;userLng=77.209;map;ngOnInit(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{this.userLat=t.coords.latitude,this.userLng=t.coords.longitude,this.initMap()},t=>{console.error("Geolocation error:",t),this.initMap()}):(console.warn("Geolocation not supported"),this.initMap())}ngAfterViewInit(){navigator.geolocation||this.initMap()}initMap(){if(typeof google>"u"||!google.maps){console.error("Google Maps API not loaded");return}this.map=new google.maps.Map(this.mapElement.nativeElement,{center:{lat:this.userLat,lng:this.userLng},zoom:12}),new google.maps.Marker({map:this.map,position:{lat:this.userLat,lng:this.userLng},title:"You are here"}),this.map.addListener("click",t=>{let e=t.latLng.lat(),r=t.latLng.lng();this.locationSelected.emit({lat:e,lng:r})})}onMapClick(t){let e=t.latLng.lat(),r=t.latLng.lng();this.locationSelected.emit({lat:e,lng:r})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=L({type:a,selectors:[["app-map"]],viewQuery:function(e,r){if(e&1&&ae(Ne,5),e&2){let i;$(i=q())&&(r.mapElement=i.first)}},outputs:{locationSelected:"locationSelected"},decls:2,vars:0,consts:[["mapElement",""],[1,"map-container",3,"mapClick"]],template:function(e,r){if(e&1){let i=S();ie(0,"div",1,0),re("mapClick",function(s){return v(i),M(r.onMapClick(s))}),ne()}},dependencies:[Fe],styles:[".map-container[_ngcontent-%COMP%]{width:100%;height:auto;min-height:400px;margin-top:10px;position:relative!important;overflow:hidden!important}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     #mapElement{width:100%;height:90%}"]})};var W=class a{_loading=new J(!1);loading$=this._loading.asObservable();show(){this._loading.next(!0)}hide(){this._loading.next(!1)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=U({token:a,factory:a.\u0275fac,providedIn:"root"})};function je(a,t){a&1&&(l(0,"div",16),p(1," Area is required. "),o())}function He(a,t){if(a&1&&(l(0,"div",21),m(1,"div",26),l(2,"span",27),p(3),o(),m(4,"div",26),o()),a&2){let e=c().index;d(3),oe(e)}}function We(a,t){if(a&1){let e=S();l(0,"button",28),C("click",function(){v(e);let i=c().index,n=c();return M(n.removeStaff(i))}),m(1,"i",29),o()}}function Ue(a,t){if(a&1&&(l(0,"option",37),p(1),o()),a&2){let e=t.$implicit;u("value",e.name),d(),D(" ",e.name," ")}}function $e(a,t){a&1&&(l(0,"div",16),p(1," Type of Staff is required. "),o())}function qe(a,t){if(a&1&&(l(0,"option",37),p(1),o()),a&2){let e=t.$implicit;u("value",e.value),d(),D(" ",e.label," ")}}function Ke(a,t){if(a&1&&(l(0,"div",16),p(1),N(2,"titlecase"),o()),a&2){let e,r=c(2).$implicit;d(),D(" Type of ",Q(2,1,(e=r.get("typeOfStaff"))==null?null:e.value)," is required. ")}}function Je(a,t){if(a&1&&(Z(0),l(1,"div",38)(2,"div",12)(3,"label",32),p(4),N(5,"titlecase"),o(),m(6,"i",39),l(7,"select",40)(8,"option",35),p(9),N(10,"titlecase"),o(),I(11,qe,2,2,"option",36),o(),z(12,Ke,3,3,"div",16),o()(),V()),a&2){let e,r,i,n,s,g=c().$implicit,h=c().index,f=c();d(3),u("for",A("typeOfSubStaff-",h)),d(),D("Select ",Q(5,11,(e=g.get("typeOfStaff"))==null?null:e.value)," Type"),d(3),E("is-invalid",((r=g.get("typeOfSubStaff"))==null?null:r.invalid)&&((r=g.get("typeOfSubStaff"))==null?null:r.touched)),u("id",A("typeOfSubStaff-",h))("disabled",!((i=g.get("typeOfStaff"))!=null&&i.value)),d(2),D("Select ",Q(10,13,(n=g.get("typeOfStaff"))==null?null:n.value)," "),d(2),u("ngForOf",f.staffSubCategories[h]),d(),k((s=g.get("typeOfSubStaff"))!=null&&s.invalid&&((s=g.get("typeOfSubStaff"))!=null&&s.touched)?12:-1)}}function Ye(a,t){if(a&1&&(l(0,"div",30)(1,"div",1)(2,"div",31)(3,"div",12)(4,"label",32),p(5,"Select Staff Type"),o(),m(6,"i",33),l(7,"select",34)(8,"option",35),p(9,"Select Type"),o(),I(10,Ue,2,2,"option",36),o(),z(11,$e,2,0,"div",16),o()(),z(12,Je,13,15,"ng-container"),o()()),a&2){let e,r,i,n=t.$implicit,s=t.index,g=c().index,h=c();u("formGroupName",s),d(4),u("for",A("typeOfStaff-",g)),d(3),E("is-invalid",((e=n.get("typeOfStaff"))==null?null:e.invalid)&&((e=n.get("typeOfStaff"))==null?null:e.touched)),u("id",A("typeOfStaff-",g)),d(3),u("ngForOf",h.staffCategories),d(),k((r=n.get("typeOfStaff"))!=null&&r.invalid&&((r=n.get("typeOfStaff"))!=null&&r.touched)?11:-1),d(),k((i=n.get("typeOfStaff"))!=null&&i.value&&((i=n.get("typeOfStaff"))==null?null:i.value)!==""?12:-1)}}function Xe(a,t){if(a&1&&(l(0,"option",37),p(1),o()),a&2){let e=t.$implicit;u("value",e),d(),D(" ",e," ")}}function et(a,t){a&1&&(l(0,"div",16),p(1," Shift Type is required. "),o())}function tt(a,t){a&1&&(l(0,"div",66),p(1," Quantity is required. "),o())}function it(a,t){if(a&1&&(l(0,"option",37),p(1),o()),a&2){let e=t.$implicit;u("value",e.value),d(),D(" ",e.label," ")}}function nt(a,t){a&1&&(l(0,"div",16),p(1," Tenure is required. "),o())}function rt(a,t){a&1&&(l(0,"div",16),p(1," Duty End Date is required. "),o())}function at(a,t){if(a&1){let e=S();l(0,"i",81),C("click",function(){v(e);let i=c(3).index,n=c();return M(n.addShift(i))}),o()}}function ot(a,t){if(a&1){let e=S();l(0,"i",82),C("click",function(){v(e);let i=c().index,n=c(2).index,s=c();return M(s.removeShiftDetail(n,i))}),o()}}function st(a,t){if(a&1){let e=S();l(0,"div",43)(1,"div",44)(2,"div",45)(3,"label",13),p(4,"Preferred Time Slot"),o(),l(5,"div",46)(6,"div",47)(7,"button",48),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.decrementTime("hours",n,i))}),m(8,"i",49),o(),m(9,"input",50),l(10,"button",51),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.incrementTime("hours",n,i))}),m(11,"i",52),o()(),l(12,"div",53)(13,"button",54),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.decrementTime("minutes",n,i))}),m(14,"i",49),o(),m(15,"input",55),l(16,"button",51),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.incrementTime("minutes",n,i))}),m(17,"i",52),o()(),l(18,"select",56)(19,"option",57),p(20,"AM"),o(),l(21,"option",58),p(22,"PM"),o()()()(),l(23,"div",59)(24,"label",13),p(25,"Shift Duration"),o(),l(26,"select",60),I(27,Xe,2,2,"option",36),o(),z(28,et,2,0,"div",16),o(),l(29,"div",61)(30,"div",12)(31,"label",62),p(32,"Prefered Gender"),o(),m(33,"i",33)(34,"input",63),o(),l(35,"div",12),m(36,"i",64)(37,"input",65),o(),z(38,tt,2,0,"div",66),o(),l(39,"div",61)(40,"label",13),p(41,"Quantity"),o(),l(42,"div",67)(43,"button",68),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.decrease("maleQuantity",n,i))}),m(44,"i",49),o(),m(45,"input",69),l(46,"button",70),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.increase("maleQuantity",n,i))}),m(47,"i",52),o()(),l(48,"div",71)(49,"button",68),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.decrease("femaleQuantity",n,i))}),m(50,"i",49),o(),m(51,"input",69),l(52,"button",70),C("click",function(){let i=v(e).index,n=c(2).index,s=c();return M(s.increase("femaleQuantity",n,i))}),m(53,"i",52),o()()(),l(54,"div",59)(55,"div",12)(56,"label",13),p(57,"Tenure"),o(),m(58,"i",72),l(59,"select",73),I(60,it,2,2,"option",36),o(),z(61,nt,2,0,"div",16),o()(),l(62,"div",11)(63,"label",13),p(64,"Duty Start Date"),o(),m(65,"input",74),o(),l(66,"div",75)(67,"label",13),p(68,"Duty End Date"),o(),m(69,"input",76),I(70,rt,2,0,"div",77),o(),l(71,"div",78),z(72,at,1,0,"i",79),z(73,ot,1,0,"i",80),o()()()}if(a&2){let e,r,i,n,s,g,h,f,w,_=t.$implicit,x=t.index,T=c(2).index,y=c();u("formGroupName",x),d(5),E("is-invalid",((e=_.get("timeSlot"))==null||e.errors==null?null:e.errors.pastTime)&&((e=_.get("timeSlot"))==null?null:e.touched)),d(4),u("value",y.pad((r=_.get("hours"))==null?null:r.value)),d(6),u("value",y.pad((i=_.get("minutes"))==null?null:i.value)),d(11),E("is-invalid",((n=_.get("shiftType"))==null?null:n.invalid)&&((n=_.get("shiftType"))==null?null:n.touched)),d(),u("ngForOf",y.shiftTypes),d(),k((s=_.get("shiftType"))!=null&&s.invalid&&((s=_.get("shiftType"))!=null&&s.touched)?28:-1),d(10),k(_.errors!=null&&_.errors.zeroQuantity&&(_.touched||_.dirty)?38:-1),d(7),u("formControlName","maleQuantity"),d(6),u("formControlName","femaleQuantity"),d(8),E("is-invalid",((g=_.get("tenure"))==null?null:g.invalid)&&((g=_.get("tenure"))==null?null:g.touched)),d(),u("ngForOf",y.tenure),d(),k((h=_.get("tenure"))!=null&&h.invalid&&((h=_.get("tenure"))!=null&&h.touched)?61:-1),d(4),u("min",y.today),d(4),u("min",((f=_.get("dutyStartDate"))==null?null:f.value)||y.today),d(),u("ngIf",((w=_.get("dutyEndDate"))==null?null:w.invalid)&&((w=_.get("dutyEndDate"))==null?null:w.touched)),d(2),k(x===0||x===y.getNestedShiftDetailsControls(T).length-1?72:-1),d(),k(x>0?73:-1)}}function lt(a,t){if(a&1&&(Z(0),l(1,"div",41),I(2,st,74,21,"div",42),o(),V()),a&2){let e=c().index,r=c();d(2),u("ngForOf",r.getNestedShiftDetailsControls(e))}}function dt(a,t){if(a&1&&(l(0,"div",20),z(1,He,5,1,"div",21),l(2,"div",22),z(3,We,2,0,"button",23),o(),l(4,"div",24),I(5,Ye,13,10,"div",25),o(),z(6,lt,3,1,"ng-container"),o()),a&2){let e,r=t.index,i=c();u("formGroupName",r),d(),k(r>0?1:-1),d(2),k(r!==0?3:-1),d(2),u("ngForOf",i.getNestedStaffDetailsControls(r)),d(),k((e=i.getNestedStaffDetailsControls(r)[0].get("typeOfStaff"))!=null&&e.value?6:-1)}}function ct(a,t){if(a&1){let e=S();Z(0),l(1,"div",83)(2,"button",84),C("click",function(){v(e);let i=c();return M(i.addNewStaff())}),m(3,"i",52),p(4,"Add Another Staff "),o()(),l(5,"div",85),m(6,"app-submission",86),o(),V()}if(a&2){let e=c();d(6),u("buttonType",e.button)}}function gt(a,t){if(a&1){let e=S();l(0,"app-authorization",87),C("loginSuccess",function(){v(e);let i=c();return M(i.onAuthSuccess())})("close",function(){v(e);let i=c();return M(i.onAuthClose())}),o()}if(a&2){let e=c();u("showAuthModal",e.showAuthPopup)("authMode","login")}}var Te=class a{constructor(t){this.spinnerService=t}fb=G(Ee);http=G(ue);router=G(pe);staffBookingForm;hours=Array.from({length:24},(t,e)=>e);minutes=[0,15,30,45];nurseTenure=["1 Day","15 Days","Monthly","Quarterly","Half Yearly","Yearly"];button="Search for staff";staffCategories=[];staffSubCategories={};shiftTypes=["2 Hours","8 Hours","12 Hours","24 Hours"];tenure=[{label:"1 Day",value:"1"},{label:"3 Days",value:"2"},{label:"1 Week",value:"3"},{label:"2 Weeks",value:"4"},{label:"1 Month",value:"5"}];today=new Date().toISOString().split("T")[0];showAadharPopup=!1;showAuthPopup=!1;time={hour:13,minute:30};meridian=!0;ngOnInit(){this.getUserLocation(),this.getStaffCategories(),this.staffBookingForm=this.fb.group({userAddress:["",b.required],latitude:[],longitude:[],staffForms:this.fb.array([this.createStaffFormGroup()])}),this.subscribeToCategoryChange(0)}getStaffCategories(){let t=j+F.CATEGORIES;this.http.get(t).subscribe({next:e=>{this.staffCategories=e||[]},error:e=>{console.error("Error fetching categories:",e)}})}subscribeToCategoryChange(t){let i=this.staffListFormArray.at(t).get("staffDetails").at(0);i.get("typeOfStaff")?.valueChanges.subscribe(n=>{let s=this.staffCategories.find(g=>g.name===n);if(s){let g=s.id;this.fetchSubCategories(g,t),i.get("typeOfSubStaff")?.setValue("")}})}incrementTime(t,e,r){let i=this.getShiftGroup(e,r);if(i)if(t==="hours"){let n=+i.get("hours")?.value||1;n=n%12+1,n===0&&(n=12),i.get("hours")?.setValue(n)}else{let n=+i.get("minutes")?.value||0;n=(n+1)%60,i.get("minutes")?.setValue(n)}}decrementTime(t,e,r){let i=this.getShiftGroup(e,r);if(i)if(t==="hours"){let n=+i.get("hours")?.value||1;n=(n-1+12)%12,n===0&&(n=12),i.get("hours")?.setValue(this.pad(n))}else{let n=+i.get("minutes")?.value||0;n=(n-1+60)%60,i.get("minutes")?.setValue(this.pad(n))}}getShiftGroup(t,e){return this.staffListFormArray.at(t).get("shiftDetails").at(e)}pad(t){return t!=null?t.toString().padStart(2,"0"):"00"}increase(t,e,r){let i=this.getQuantityControl(t,e,r);i.setValue(Math.min((i.value||0)+1,10)),this.updateGenderInShift(e,r)}decrease(t,e,r){let i=this.getQuantityControl(t,e,r);i.setValue(Math.max((i.value||1)-1,0)),this.updateGenderInShift(e,r)}updateGenderInShift(t,e){let r=this.getShiftGroup(t,e);r&&this.updateGenderQty(r)}getQuantityControl(t,e,r){return this.staffListFormArray.at(e).get("shiftDetails").at(r).get(t==="maleQuantity"?"maleQuantity":"femaleQuantity")}getUserLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{let e=t.coords.latitude,r=t.coords.longitude;this.getAddressFromCoords(e,r)},t=>{console.error("Geolocation failed:",t)}):console.error("Geolocation not supported by this browser.")}getAddressFromCoords(t,e){this.staffBookingForm.patchValue({latitude:t,longitude:e});let r=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${t}&lon=${e}`;this.http.get(r).subscribe(i=>{let n=i.display_name;n&&this.staffBookingForm.patchValue({userAddress:n})},i=>{console.error("Error fetching address:",i)})}createStaffDetailFormGroup(){return this.fb.group({typeOfStaff:["",b.required],typeOfSubStaff:["",b.required]})}fetchSubCategories(t,e){let r=`${j}${F.CATEGORIES}/${t}${F.SUB_CATEGORIES}`;this.http.get(r).subscribe({next:i=>{this.staffSubCategories[e]=i},error:i=>{console.error("Failed to fetch subcategories",i),this.staffSubCategories[e]=[]}})}createShiftDetailFormGroup(){let e=new Date().getHours(),r="00",i=e>=12?"PM":"AM";e===0?e=12:e>12&&(e-=12);let n=this.fb.group({shiftType:["",b.required],timeSlot:[""],tenure:["1"],dutyStartDate:[new Date().toISOString().substring(0,10)],dutyEndDate:["",b.required],maleQuantity:["0",[b.min(0),b.max(10)]],femaleQuantity:["0",[b.min(0),b.max(10)]],hours:[e,[b.required,b.min(1),b.max(12)]],minutes:[r,[b.required,b.min(0),b.max(59)]],ampm:[i,b.required]},{validators:[this.shiftDurationValidator]});return n.get("hours")?.valueChanges.subscribe(()=>this.updateTimeSlot(n)),n.get("minutes")?.valueChanges.subscribe(()=>this.updateTimeSlot(n)),n.get("ampm")?.valueChanges.subscribe(()=>this.updateTimeSlot(n)),n.get("maleQuantity")?.valueChanges.subscribe(()=>this.updateGenderQty(n)),n.get("femaleQuantity")?.valueChanges.subscribe(()=>this.updateGenderQty(n)),n.get("dutyStartDate")?.valueChanges.subscribe(s=>{if(!s){let h=new Date().toISOString().substring(0,10);n.get("dutyStartDate")?.setValue(h,{emitEvent:!1});return}let g=n.get("dutyEndDate");if(g){let h=g.value;h&&new Date(h)<new Date(s)&&g.setValue(s,{emitEvent:!1})}}),n}updateTimeSlot(t){let e=t.get("hours")?.value??0,r=t.get("minutes")?.value??0,i=t.get("ampm")?.value??"AM",n=h=>h.toString().padStart(2,"0"),s=`${n(+e)}:${n(+r)} ${i}`,g=t.get("timeSlot");g?.setValue(s,{emitEvent:!1}),g?.markAsTouched(),g?.markAsDirty()}updateGenderQty(t){let e=Number(t.get("maleQuantity")?.value||0),r=Number(t.get("femaleQuantity")?.value||0);t.get("maleQuantity")?.setValue(e),t.get("gender")?.setValue(r)}createStaffFormGroup(){return this.fb.group({staffDetails:this.fb.array([this.createStaffDetailFormGroup()]),shiftDetails:this.fb.array([this.createShiftDetailFormGroup()])})}addShift(t){this.staffListFormArray.at(t).get("shiftDetails").push(this.createShiftDetailFormGroup())}removeShiftDetail(t,e){this.staffListFormArray.at(t).get("shiftDetails").removeAt(e)}addNewStaff(){this.staffListFormArray.push(this.createStaffFormGroup());let t=this.staffListFormArray.length-1;this.subscribeToCategoryChange(t)}get staffListFormArray(){return this.staffBookingForm.get("staffForms")}getNestedShiftDetailsControls(t){return this.staffListFormArray.at(t).get("shiftDetails").controls}getNestedStaffDetailsControls(t){return this.staffListFormArray.at(t).get("staffDetails").controls}removeStaff(t){this.staffListFormArray.removeAt(t)}onSubmit(){let t=this.hasPastTimeError(),e=this.hasZeroQuantityError();if(!this.staffBookingForm.valid||t||e){this.markAllAsTouched(this.staffBookingForm);return}let r=localStorage.getItem("authToken")||sessionStorage.getItem("authToken"),n=JSON.parse(localStorage.getItem("userProfile")||"{}").aadhaarStatus===!0;if(!r){console.log("User not logged in. Redirecting to login page."),this.showAuthPopup=!0;return}this.spinnerService.show();let s=j+F.BOOK_STAFF,g=B(O({},this.staffBookingForm.value),{staffForms:this.staffListFormArray.controls.map(f=>{let w=f.get("staffDetails").at(0),{typeOfStaff:_,typeOfSubStaff:x}=w.value,T=f.get("shiftDetails").controls.map(y=>{let{shiftType:P,timeSlot:R,tenure:Pe,maleQuantity:Re,femaleQuantity:Be,dutyStartDate:Ge,dutyEndDate:Ze}=y.value;return{shiftType:P,timeSlot:R,tenure:Pe,maleQuantity:Re,femaleQuantity:Be,dutyStartDate:Ge,dutyEndDate:Ze}});return{typeOfStaff:_,typeOfSubStaff:x,shifts:T}})}),h=new ge({"Content-Type":"application/json"});h=h.set("Authorization",`Bearer ${r}`),this.http.post(s,g,{headers:h}).subscribe({next:f=>{if(this.spinnerService.hide(),f?.status===!0){let w=f?.staff?.[0]?.staffDetails||[];this.router.navigate(["/view-staff"],{state:{staffDetails:w,bookingIds:f.bookingIds}})}else alert(f?.message||"Something went wrong.")},error:f=>{console.error("Staff search API call failed:",f),this.spinnerService.hide(),alert("An error occurred while processing your request.")}})}onAuthSuccess(){this.showAuthPopup=!1,this.onSubmit()}onAuthClose(){this.showAuthPopup=!1}onAadharVerified(){this.showAadharPopup=!1;let t=JSON.parse(localStorage.getItem("userProfile")||"{}");t.aadhaarStatus=!1,localStorage.setItem("userProfile",JSON.stringify(t)),this.onSubmit()}hasPastTimeError(){let t=!1;return this.staffListFormArray.controls.forEach(e=>{e.get("shiftDetails").controls.forEach(i=>{let n=i.get("dutyStartDate")?.value,s=+i.get("hours")?.value,g=+i.get("minutes")?.value,h=i.get("ampm")?.value;if(!n||s==null||g==null||!h)return;let f=new Date(n),w=new Date,_=y=>y.toString().padStart(2,"0"),x=`${_(s)}:${_(g)} ${h}`;if(i.get("timeSlot")?.setValue(x,{emitEvent:!1}),f.getFullYear()===w.getFullYear()&&f.getMonth()===w.getMonth()&&f.getDate()===w.getDate()){let y=s;h==="PM"&&y!==12&&(y+=12),h==="AM"&&y===12&&(y=0);let P=new Date;if(P.setHours(y,g,0,0),P<w)i.get("timeSlot")?.setErrors({pastTime:!0}),t=!0;else{let R=i.get("timeSlot");R?.hasError("pastTime")&&R.setErrors(null)}}})}),t}hasZeroQuantityError(){let t=!1;return this.staffListFormArray.controls.forEach(e=>{e.get("shiftDetails").controls.forEach(i=>{let n=+i.get("maleQuantity")?.value||0,s=+i.get("femaleQuantity")?.value||0;if(n===0&&s===0)i.setErrors(B(O({},i.errors||{}),{zeroQuantity:!0})),t=!0;else if(i.errors?.zeroQuantity){let g=O({},i.errors);delete g.zeroQuantity,i.setErrors(Object.keys(g).length?g:null)}})}),t}markAllAsTouched(t){Object.values(t.controls).forEach(e=>{e.markAsTouched(),(e instanceof fe||e instanceof De)&&this.markAllAsTouched(e)})}shiftDurationValidator(t){let e=parseInt(t.get("shiftHour")?.value,10),r=parseInt(t.get("shiftMinute")?.value,10);if(isNaN(e)||isNaN(r))return null;let i=e*60+r,n=(i+8*60)%(24*60);return i>=0&&n>=0?null:{invalidShiftDuration:!0}}static \u0275fac=function(e){return new(e||a)(X(W))};static \u0275cmp=L({type:a,selectors:[["app-book-staff"]],decls:23,vars:7,consts:[[1,"container-fluid",2,"margin-top","-48px"],[1,"row"],[1,"col-md-4","h-100"],[3,"locationSelected"],[1,"col-md-8","search-staff-form"],[1,"form-scroll-container"],[1,"form-content"],[1,"form-title"],[3,"ngSubmit","formGroup"],[1,"form"],[1,"row","my-3"],[1,"col-md-12"],[1,"form-group"],[1,"form-label"],[1,"bi","bi-geo-alt","address"],["type","text","formControlName","userAddress",1,"form-control","ps-4"],[1,"invalid-feedback"],["formArrayName","staffForms",1,"staff-list"],["class","pe-2",3,"formGroupName",4,"ngFor","ngForOf"],[3,"showAuthModal","authMode"],[1,"pe-2",3,"formGroupName"],[1,"indexed-divider-container"],[1,"col-md-12","d-flex","justify-content-end"],["type","button","title","Remove Staff",1,"btn","btn-outline-danger","btn-lg","rounded-circle","d-flex","align-items-center","justify-content-center",2,"width","20px","height","30px"],["formArrayName","staffDetails"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"line"],[1,"index-number"],["type","button","title","Remove Staff",1,"btn","btn-outline-danger","btn-lg","rounded-circle","d-flex","align-items-center","justify-content-center",2,"width","20px","height","30px",3,"click"],[1,"bi","bi-trash","fs-5"],[3,"formGroupName"],[1,"col-md-12","mb-2"],[1,"form-label",3,"for"],[1,"bi","bi-person","address"],["formControlName","typeOfStaff",1,"form-select","ps-4",3,"id"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"col-md-12","my-3"],[1,"bi","bi-people","address"],["formControlName","typeOfSubStaff",1,"form-select","ps-4",3,"id","disabled"],["formArrayName","shiftDetails"],["class","shift-detail",3,"formGroupName",4,"ngFor","ngForOf"],[1,"shift-detail",3,"formGroupName"],[1,"row","d-flex"],[1,"col-md-4"],[1,"d-flex","align-items-center"],[1,"d-flex","align-items-center","border","rounded"],["type","button",1,"btn","btn-minus","px-0","ps-1","text-primary",3,"click"],[1,"bi","bi-dash"],["type","number","formControlName","hours","value","09","min","0","max","12","readonly","",1,"form-control","px-0","ps-2","hrsMin","border-0",3,"value"],["type","button",1,"btn","btn-plus","px-0","text-primary",3,"click"],[1,"bi","bi-plus"],[1,"align-items-center","d-flex","border","rounded","mx-2"],["type","button",1,"btn","btn-minus","px-2","text-primary",3,"click"],["type","number","formControlName","minutes","value","00","min","0","max","59","readonly","",1,"form-control","px-0","hrsMin","border-0",3,"value"],["formControlName","ampm",1,"form-select","time-select","px-0","ps-2","amPm"],["value","AM"],["value","PM"],[1,"col-md-2"],["formControlName","shiftType",1,"form-select","pe-1"],[1,"col-md-2","col-6","col-sm-6"],[1,"form-label","d-block"],["type","text","readonly","","value","Male",1,"form-control","ps-4"],[1,"bi","bi-person","address","female"],["type","text","readonly","","value","Female",1,"form-control","mt-2","ps-4"],[1,"text-danger"],[1,"d-flex","align-items-center","mb-2","counter-box"],["type","button",1,"btn","btn-minus","px-0",3,"click"],["type","number","min","0","max","10","readonly","","readonly","",1,"form-control",3,"formControlName"],["type","button",1,"btn","btn-plus","px-0",3,"click"],[1,"d-flex","align-items-center","counter-box"],[1,"bi","bi-calendar4","address"],["formControlName","tenure",1,"form-select","ps-4","pe-1"],["type","date","formControlName","dutyStartDate",1,"form-control",3,"min"],[1,"col-md-12","mt-2"],["type","date","formControlName","dutyEndDate",1,"form-control",3,"min"],["class","invalid-feedback",4,"ngIf"],[1,"d-flex","align-items-start","justify-content-end","gap-2","mt-3"],["title","Add Time Slot",1,"bi","bi-plus-lg","add"],["title","Remove Time Slot",1,"bi","bi-trash","text-danger","remove"],["title","Add Time Slot",1,"bi","bi-plus-lg","add",3,"click"],["title","Remove Time Slot",1,"bi","bi-trash","text-danger","remove",3,"click"],[1,"d-flex","justify-content-center","addNewBtn","my-2"],["type","button",1,"btn",3,"click"],[1,"submission-fixed","d-flex","justify-content-end"],[3,"buttonType"],[3,"loginSuccess","close","showAuthModal","authMode"]],template:function(e,r){if(e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-map",3),C("locationSelected",function(n){return r.getAddressFromCoords(n.lat,n.lng)}),o()(),l(4,"div",4)(5,"div",5)(6,"div",6)(7,"h2",7),p(8,"Please fill the form"),o(),l(9,"form",8),C("ngSubmit",function(){return r.onSubmit()}),l(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),p(15,"Select your area"),o(),m(16,"i",14)(17,"input",15),z(18,je,2,0,"div",16),o()()(),l(19,"div",17),I(20,dt,7,5,"div",18),o()(),z(21,ct,7,1,"ng-container"),o()()()()()(),z(22,gt,1,2,"app-authorization",19)),e&2){let i,n,s;d(9),u("formGroup",r.staffBookingForm),d(8),E("is-invalid",((i=r.staffBookingForm.get("userAddress"))==null?null:i.invalid)&&((i=r.staffBookingForm.get("userAddress"))==null?null:i.touched)),d(),k((n=r.staffBookingForm.get("userAddress"))!=null&&n.invalid&&((n=r.staffBookingForm.get("userAddress"))!=null&&n.touched)?18:-1),d(2),u("ngForOf",r.staffListFormArray.controls),d(),k(!((s=r.staffListFormArray.controls[0].get("staffDetails"))==null||(s=s.get("0"))==null||(s=s.get("typeOfStaff"))==null)&&s.value?21:-1),d(),k(r.showAuthPopup?22:-1)}},dependencies:[ce,se,le,Oe,ye,we,Ie,he,ve,ke,me,_e,xe,Se,Me,ze,be,Ce,H,Le,Ae,de],styles:[".staff-list[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:scroll}.staff-list[_ngcontent-%COMP%]:hover{overflow-y:auto}.staff-list[_ngcontent-%COMP%]:focus-within{overflow-y:auto}.staff-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px;height:8px}.staff-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff;border-radius:10px}.staff-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#09b8c2;border-radius:10px}.staff-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#fff}.indexed-divider-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0;color:#6c757d;font-weight:700;font-size:.9rem}.line[_ngcontent-%COMP%]{flex-grow:1;height:1px;background-color:#dee2e6}.index-number[_ngcontent-%COMP%]{color:#09b8c2;padding:5px 12px;background-color:#e0fcff;border-radius:50%;min-width:25px;text-align:center;box-shadow:0 1px 3px #0000000d}.form-group[_ngcontent-%COMP%]{position:relative}.address[_ngcontent-%COMP%]{position:absolute;left:5px;top:36px;color:#09b8c2}.female[_ngcontent-%COMP%]{top:8px!important}.hrsMin[_ngcontent-%COMP%]{width:40px!important}.amPm[_ngcontent-%COMP%]{width:70px!important}"]})};export{Te as BookStaff};
