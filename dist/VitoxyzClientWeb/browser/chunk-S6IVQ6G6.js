import{a as I,b as F}from"./chunk-TNRG4YRG.js";import{c as E,g as y}from"./chunk-UF26DDQM.js";import{i as v,q as w,w as S,y as k}from"./chunk-HSQUREWB.js";import{Ab as _,Pb as m,Qb as t,Rb as e,Sb as l,Zb as b,bb as O,cc as d,eb as p,ec as u,na as f,oa as h,pb as P,qc as M,sc as n,tc as x,vb as C}from"./chunk-36LOJXOE.js";function z(c,a){c&1&&(t(0,"div",47)(1,"div",48),l(2,"i",49),e(),t(3,"div",50),n(4," Uploaded prescriptions will be shown here "),e()())}function U(c,a){if(c&1&&(t(0,"div",57),l(1,"img",58),e()),c&2){let o=u(2);p(),m("src",o.attachedPreview,O)}}function D(c,a){if(c&1){let o=b();t(0,"div",51)(1,"div",52)(2,"div",53),n(3),e(),t(4,"div",54)(5,"button",55),d("click",function(){f(o);let r=u();return h(r.removeAttachment())}),n(6," Remove "),e()()(),_(7,U,2,1,"div",56),e()}if(c&2){let o=u();p(3),x(o.attachedFile.name),p(4),m("ngIf",o.attachedPreview)}}function R(c,a){if(c&1){let o=b();t(0,"div",59),d("click",function(){f(o);let r=u();return h(r.closeSheet())}),e()}}var T=class c{constructor(a,o){this.router=a;this.http=o}attachedFile=null;attachedPreview=null;showMobileSheet=!1;isUploading=!1;savedPrescriptions=[{id:1,name:"Prescription - 01.jpg"},{id:2,name:"Prescription - 02.pdf"}];onFileSelected(a){let i=a.target.files;if(!i||i.length===0)return;let r=i[0];if(this.attachedFile=r,r.type.startsWith("image/")){let s=new FileReader;s.onload=()=>{this.attachedPreview=s.result},s.readAsDataURL(r)}else this.attachedPreview=null;this.closeSheet()}triggerFileInput(){document.getElementById("mobileFileInput")?.click()}openSavedPrescriptions(){let a=this.savedPrescriptions[0];a&&(this.attachedFile=new File([],a.name),this.attachedPreview=null),this.closeSheet()}removeAttachment(){this.attachedFile=null,this.attachedPreview=null}onContinue(){if(!this.attachedFile){alert("Please attach a prescription to continue.");return}alert("Continue \u2014 upload logic goes here."),this.uploadPrescription(this.attachedFile)}uploadPrescription(a){this.isUploading=!0;let o=new FormData;o.append("file",a),o.append("medicineId",""),o.append("medicineName","General Prescription");let i=localStorage.getItem("authToken"),r=i?new Headers({Authorization:`Bearer ${i}`}):new Headers,s=i?{headers:new S({Authorization:`Bearer ${i}`})}:{};this.http.post(`${I}${F.PRESCRIPTION}`,o,s).subscribe({next:g=>{this.isUploading=!1,g.status?(alert("\u2705 "+g.message),console.log("Upload success:",g.data),this.router.navigate(["/"])):alert("\u274C Upload failed: "+(g.message||"Unknown error"))},error:g=>{this.isUploading=!1,console.error("Upload error:",g),alert("\u274C Something went wrong while uploading.")}})}goBack(){this.router.navigate(["/"])}openSheet(){this.showMobileSheet=!0}closeSheet(){this.showMobileSheet=!1}static \u0275fac=function(o){return new(o||c)(P(E),P(k))};static \u0275cmp=C({type:c,selectors:[["app-order-prescription"]],decls:87,vars:5,consts:[[1,"container"],[1,"row","gx-4"],[1,"col-lg-6","mb-4"],[1,"card","upload-card"],[1,"card-body"],[1,"title"],[1,"muted"],[1,"d-grid","gap-3","mt-3"],["for","fileInput",1,"action-btn","upload-new"],[1,"icon"],[1,"fi-rr-upload"],[1,"text"],[1,"label"],[1,"sub"],["id","fileInput","type","file","hidden","",3,"change"],["type","button",1,"action-btn","saved-btn",3,"click"],[1,"fi","fi-tr-floppy-disks"],[1,"label","text-white"],[1,"sub","text-white"],[1,"attached","mt-4"],[1,"attached-title"],["class","attached-placeholder",4,"ngIf"],["class","attached-preview",4,"ngIf"],[1,"d-flex","gap-2","mt-4"],[1,"btn","text-white","rounded-pill","btn-sm","px-3",3,"click"],[1,"btn","ms-auto","text-white","rounded-pill","btn-sm",3,"click"],[1,"card","guide-card"],[1,"guide-grid","d-flex","flex-column","flex-lg-row","gap-3","mt-3"],[1,"guide-art"],[1,"doc-sample"],[1,"doc-top"],[1,"doc-lines"],[1,"line"],[1,"doc-sign"],[1,"guide-list"],[1,"gov-note","mt-3"],["class","mobile-sheet-backdrop",3,"click",4,"ngIf"],[1,"mobile-sheet"],[1,"sheet-header"],[1,"close-btn",3,"click"],[1,"bi","bi-x-lg"],[1,"sheet-body"],[1,"sheet-action",3,"click"],[1,"bi","bi-camera"],[1,"bi","bi-image"],[1,"bi","bi-folder2-open"],["id","mobileFileInput","type","file","accept","image/*,.pdf","hidden","",3,"change"],[1,"attached-placeholder"],[1,"placeholder-icon"],[1,"bi","bi-file-earmark-text"],[1,"placeholder-text","muted"],[1,"attached-preview"],[1,"preview-row","d-flex","align-items-center","justify-content-between"],[1,"preview-name"],[1,"preview-actions"],["aria-label","Remove",1,"btn","btn-link","p-0",3,"click"],["class","image-wrap mt-3",4,"ngIf"],[1,"image-wrap","mt-3"],["alt","Prescription preview",3,"src"],[1,"mobile-sheet-backdrop",3,"click"]],template:function(o,i){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),n(6,"Upload Prescription"),e(),t(7,"p",6),n(8,"Please attach a prescription to proceed"),e(),t(9,"div",7)(10,"label",8)(11,"div",9),l(12,"i",10),e(),t(13,"div",11)(14,"div",12),n(15,"UPLOAD NEW"),e(),t(16,"div",13),n(17,"Attach a photo or pdf of the prescription"),e()()(),t(18,"input",14),d("change",function(s){return i.onFileSelected(s)}),e(),t(19,"button",15),d("click",function(){return i.openSavedPrescriptions()}),t(20,"div",9),l(21,"i",16),e(),t(22,"div",11)(23,"div",17),n(24,"SAVED PRESCRIPTIONS"),e(),t(25,"div",18),n(26,"Choose from previously uploaded files"),e()()()(),t(27,"div",19)(28,"h6",20),n(29,"Attached Prescription"),e(),_(30,z,5,0,"div",21)(31,D,8,2,"div",22),e(),t(32,"div",23)(33,"button",24),d("click",function(){return i.goBack()}),n(34," Back "),e(),t(35,"button",25),d("click",function(){return i.onContinue()}),n(36," Continue "),e()()()()(),t(37,"div",2)(38,"div",26)(39,"div",4)(40,"h4",5),n(41,"Guide for a valid prescription"),e(),t(42,"div",27)(43,"div",28)(44,"div",29)(45,"div",30),n(46,"Dr. Varun, MBBS, MD"),e(),t(47,"div",31)(48,"div",32),n(49," Name of Patient ___________ Age __ "),e(),t(50,"div",32),n(51," Medicine Name \u2022 Strength \u2022 Dose \u2022 Duration "),e()(),l(52,"div",33),e()(),t(53,"div",34)(54,"ul")(55,"li"),n(56,"Don't crop out any part of the image"),e(),t(57,"li"),n(58,"Avoid blurred image"),e(),t(59,"li"),n(60,"Include doctor & patient details + date"),e(),t(61,"li"),n(62,"Medicines dispensed as per prescription"),e(),t(63,"li"),n(64,"Supported files: jpeg, jpg, png, pdf"),e(),t(65,"li"),n(66,"Max file size: 5MB"),e()()()(),t(67,"p",35),n(68," Government regulations require a valid prescription "),e()()()()()(),_(69,R,1,0,"div",36),t(70,"div",37)(71,"div",38)(72,"h5"),n(73,"Upload prescriptions"),e(),t(74,"button",39),d("click",function(){return i.closeSheet()}),l(75,"i",40),e()(),t(76,"div",41)(77,"button",42),d("click",function(){return i.triggerFileInput()}),l(78,"i",43),n(79," Take a photo "),e(),t(80,"button",42),d("click",function(){return i.triggerFileInput()}),l(81,"i",44),n(82," Choose from gallery "),e(),t(83,"button",42),d("click",function(){return i.openSavedPrescriptions()}),l(84,"i",45),n(85," Your prescriptions "),e()()(),t(86,"input",46),d("change",function(s){return i.onFileSelected(s)}),e()),o&2&&(p(30),m("ngIf",!i.attachedFile),p(),m("ngIf",i.attachedFile),p(38),m("ngIf",i.showMobileSheet),p(),M("active",i.showMobileSheet))},dependencies:[w,v,y],styles:['.order-prescription[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-radius:8px;border:1px solid #ececec;box-shadow:0 6px 18px #0f172a0a}.title[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:500}.muted[_ngcontent-%COMP%]{color:#6c757d;margin:0}.upload-card[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;padding:14px 16px;border-radius:8px;border:1px solid #f0f0f0;background:#fff;cursor:pointer;width:100%}.upload-card[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{min-width:44px;min-height:44px;border-radius:8px;display:inline-flex;align-items:center;justify-content:center;font-size:1.25rem}.upload-card[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;font-size:.95rem}.upload-card[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{font-size:.85rem}.upload-card[_ngcontent-%COMP%]   .upload-new[_ngcontent-%COMP%]{border-color:#efe6e6}.upload-card[_ngcontent-%COMP%]   .upload-new[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#ef6b63;background:#fff6f6}.upload-card[_ngcontent-%COMP%]   .saved-btn[_ngcontent-%COMP%]{border-color:#efe6e6;background:#fafafa}.upload-card[_ngcontent-%COMP%]   .saved-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#d35400;background:#fff7f0}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-title[_ngcontent-%COMP%]{font-weight:500;margin-bottom:10px}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-placeholder[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;padding:18px;border-radius:8px;background:#fbfbfb;border:1px dashed #eee}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-placeholder[_ngcontent-%COMP%]   .placeholder-icon[_ngcontent-%COMP%]{font-size:1.4rem;color:#bfc6c9}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-placeholder[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{color:#9aa0a6}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-preview[_ngcontent-%COMP%]   .preview-row[_ngcontent-%COMP%]{font-weight:600}.upload-card[_ngcontent-%COMP%]   .attached[_ngcontent-%COMP%]   .attached-preview[_ngcontent-%COMP%]   .image-wrap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:260px;object-fit:contain;border-radius:6px;border:1px solid #f0f0f0}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]{gap:16px}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .doc-sample[_ngcontent-%COMP%]{width:100%;max-width:320px;min-height:320px;border:1px solid #f2e8e8;border-radius:6px;padding:12px;background:linear-gradient(180deg,#fff,#fffaf8)}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .doc-sample[_ngcontent-%COMP%]   .doc-top[_ngcontent-%COMP%]{font-weight:500;margin-bottom:6px}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .doc-sample[_ngcontent-%COMP%]   .doc-lines[_ngcontent-%COMP%]{color:#7a7a7a;font-size:.9rem}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .guide-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:0;margin:0;list-style:none}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .guide-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;padding-left:28px;margin-bottom:8px;color:#4d4d4d;font-size:.95rem}.guide-card[_ngcontent-%COMP%]   .guide-grid[_ngcontent-%COMP%]   .guide-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"\\f280";font-family:bootstrap-icons;position:absolute;left:0;top:2px;font-size:1rem;color:#db9280}.guide-card[_ngcontent-%COMP%]   .gov-note[_ngcontent-%COMP%]{color:#8a8a8a;font-size:.9rem}.mobile-sheet-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);z-index:1040;display:none}.mobile-sheet[_ngcontent-%COMP%]{position:fixed;left:0;right:0;bottom:-100%;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px;box-shadow:0 -4px 12px #0000001a;transition:all .3s ease-in-out;z-index:1050;padding:16px 20px}.mobile-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.mobile-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-weight:500;font-size:1rem}.mobile-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.2rem}.mobile-sheet[_ngcontent-%COMP%]   .sheet-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:10px}.mobile-sheet[_ngcontent-%COMP%]   .sheet-body[_ngcontent-%COMP%]   .sheet-action[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:14px;font-size:.95rem;border:none;background:#f8f8f8;border-radius:10px;margin-bottom:10px;text-align:left}.mobile-sheet.active[_ngcontent-%COMP%]{bottom:0}@media (max-width: 767.98px){.order-prescription[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column}.order-prescription[_ngcontent-%COMP%]   .guide-card[_ngcontent-%COMP%]{display:none}.mobile-sheet-backdrop[_ngcontent-%COMP%]{display:block}}.card[_ngcontent-%COMP%]{background-color:#fbf8eb}']})};export{T as OrderPrescription};
