<app-header></app-header>

<!-- <ng-container *ngIf="medicineType === 'health' && isLoaded && !hasError; else loadingOrError">

  <div class="container mt-4 product-detail">
    <div class="row">

      
      <div class="col-md-6 d-flex" *ngIf="!isMobile">
        <div class="d-flex flex-column me-3">
          <img *ngFor="let img of medicine.images"
               [src]="img"
               class="thumb-img mb-2"
               (click)="selectedImage = img" />
        </div>
        <div>
          <img [src]="selectedImage" class="main-img" />
        </div>
      </div>

      
      <div *ngIf="isMobile" class="mobile-carousel">
        <div class="carousel-wrapper">
          <div class="carousel-track" [style.transform]="'translateX(-' + currentIndex*100 + '%)'">
            <div class="carousel-item" *ngFor="let img of medicine.images">
              <img [src]="img" class="main-img-mobile" />
            </div>
          </div>
          <button class="nav prev" (click)="prevSlide()">‹</button>
          <button class="nav next" (click)="nextSlide()">›</button>
        </div>
        <div class="dots">
          <span *ngFor="let img of medicine.images; let i = index"
                [class.active]="i === currentIndex"
                (click)="goToSlide(i)"></span>
        </div>
      </div>

      
      <div class="col mt-3">
        <h3>{{ medicine.name }}</h3>
        <p class="manufacturer">{{ medicine.manufacturer }}</p>

        <div class="rating mb-2">
          <span class="badge bg-warning text-dark">{{ medicine.rating }}★</span>
          <small>{{ medicine.reviewsCount }} Ratings & {{ medicine.reviewTextCount }} Reviews</small>
        </div>

        <h5>Product highlights</h5>
        <ul><li *ngFor="let point of medicine.highlights">{{ point }}</li></ul>

        <div class="price-box my-2 mt-3">
          <h4 class="text-primary">
            ₹{{ medicine.price }} <small class="text-muted">₹{{ medicine.mrp }}</small>
            <span class="text-success" *ngIf="medicine.discount">{{ medicine.discount }}% off</span>
          </h4>
        </div>

        <div class="quantity mb-3">
          <label>Qty:</label>
          <select [(ngModel)]="selectedQty" class="form-select w-auto d-inline-block ms-2">
            <option *ngFor="let qty of medicine.packSizes" [value]="qty">{{ qty }}</option>
          </select>
        </div>

        <button class="btn btn-primary btn-lg mb-3 mt-3" (click)="addToCart()">Add to cart</button>

        <div class="delivery mt-3">
          <strong>Get by {{ medicine.deliveryTime }}</strong>
        </div>
      </div>
    </div>

   
    <div class="description my-4">
      <p class="mb-1">{{ medicine.introduction }}</p>
      <p class="headings mb-1">{{ medicine.description }}</p>
      <p class="headings mb-1">How to use:</p>
      <p class="mb-1">{{ medicine.howToUse }}</p>
      <p class="headings mb-1">Safety Advice:</p>
      <p class="mb-1" [innerHTML]="medicine.safetyAdvise"></p>
      <p class="headings mb-1">Common Side Effects:</p>
      <p class="mb-1">{{ medicine.commonSideEffect }}</p>
      <p class="headings mb-1">Storage:</p>
      <p class="mb-1">{{ medicine.storage }}</p>
    </div>
  </div>
</ng-container> -->

<ng-container *ngIf="medicineType === 'otc' && isLoaded && !hasError; else loadingOrError">
  <div class="container mt-4 product-detail">
    <div class="row">
      <!-- Desktop -->
      <div class="col-md-6 d-flex" *ngIf="!isMobile">
        <div class="d-flex flex-column me-3">
          <img *ngFor="let img of product.images"
               [src]="img"
               class="thumb-img mb-2"
               (click)="selectedImage = img" />
        </div>
        <div>
          <img [src]="selectedImage" class="main-img" />
        </div>
      </div>
      <!-- Mobile carousel -->
      <div *ngIf="isMobile" class="mobile-carousel">
        <div class="carousel-wrapper">
          <div class="carousel-track" [style.transform]="'translateX(-' + currentIndex*100 + '%)'">
            <div class="carousel-item" *ngFor="let img of product.images">
              <img [src]="img" class="main-img-mobile" />
            </div>
          </div>
          <button class="nav prev" (click)="prevSlide()">‹</button>
          <button class="nav next" (click)="nextSlide()">›</button>
        </div>
        <div class="dots">
          <span *ngFor="let img of product.images; let i = index"
                [class.active]="i === currentIndex"
                (click)="goToSlide(i)"></span>
        </div>
      </div>

      <div class="col mt-3">
        <h3>{{ product.name }}</h3>
        <p class="manufacturer">{{ product.manufacturer }}</p>

        <div class="rating mb-2">
          <span class="badge bg-warning text-light">{{ product.rating }}★</span>
          <small>{{ product.reviewsCount }} Ratings & {{ product.reviewTextCount }} Reviews</small>
        </div>

        <h5>Product highlights</h5>
        <ul><li *ngFor="let point of product.highlights">{{ point }}</li></ul>

        <div class="price-box my-2 mt-3">
          <h4 class="text-primary">
            ₹{{ product.price }} <small class="text-muted">₹{{ product.mrp }}</small>
            <span class="text-success" *ngIf="product.discount">{{ product.discount }}% off</span>
          </h4>
        </div>

        <div class="quantity mb-3">
          <label>Qty:</label>
          <select [(ngModel)]="selectedQty" class="form-select w-auto d-inline-block ms-2">
            <option *ngFor="let qty of product.packSizes" [value]="qty">{{ qty }}</option>
          </select>
        </div>

        <button class="btn btnCls btn-lg mt-3" (click)="addToCartOtc()">Add to cart</button>

        <!-- <div class="delivery mt-3">
          <strong>Get by {{ product.deliveryTime }}</strong>
        </div> -->
      </div>
    </div>

    <div class="description my-4">
      <p class="mb-1">{{ product.introduction }}</p>
      <p class="headings mb-1">{{ product.description }}</p>
      <p class="headings mb-1">How to use:</p>
      <p class="mb-1">{{ product.howToUse }}</p>
      <p class="headings mb-1">Safety Advice:</p>
      <p class="mb-1" [innerHTML]="product.safetyAdvise"></p>
      <p class="headings mb-1">Common Side Effects:</p>
      <p class="mb-1">{{ product.commonSideEffect }}</p>
      <p class="headings mb-1">Storage:</p>
      <p class="mb-1">{{ product.storage }}</p>
    </div>
  </div>
</ng-container>

<!-- <ng-template #loadingOrError>
  <p *ngIf="!isLoaded">Loading medicine details…</p>
  <p *ngIf="isLoaded && hasError">Could not load medicine details.</p>
</ng-template> -->
<ng-template #loadingOrError>
  <div *ngIf="!isLoaded" class="vm-loading" role="status" aria-live="polite">
    <div class="vm-spinner" aria-hidden="true"></div>
    <div class="vm-loading-text">Loading medicine details…</div>
  </div>

  <p *ngIf="isLoaded && hasError" class="vm-error">
    Could not load medicine details.
  </p>
</ng-template>
<app-footer></app-footer>
<app-mobile-footer-nav></app-mobile-footer-nav>
